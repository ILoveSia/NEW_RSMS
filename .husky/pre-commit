#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

echo "ğŸ” Pre-commit hooks ì‹¤í–‰ ì¤‘..."

# Lint-staged ì‹¤í–‰
npx lint-staged

# ì»¤ìŠ¤í…€ ê²€ì‚¬ ì‹¤í–‰
echo "ğŸ“‹ ì½”ë“œ í’ˆì§ˆ ê²€ì‚¬ ì¤‘..."

# Frontend íƒ€ì… ì²´í¬
if [ -d "frontend" ]; then
    echo "ğŸ”· Frontend TypeScript ê²€ì‚¬ ì¤‘..."
    cd frontend
    npm run type-check
    if [ $? -ne 0 ]; then
        echo "âŒ TypeScript íƒ€ì… ì˜¤ë¥˜ ë°œê²¬. ì»¤ë°‹ì´ ì¤‘ë‹¨ë©ë‹ˆë‹¤."
        exit 1
    fi
    cd ..
fi

# Backend ì»´íŒŒì¼ ê²€ì‚¬
if [ -d "backend" ]; then
    echo "â˜• Backend Java ì»´íŒŒì¼ ê²€ì‚¬ ì¤‘..."
    cd backend
    ./gradlew compileJava compileTestJava
    if [ $? -ne 0 ]; then
        echo "âŒ Java ì»´íŒŒì¼ ì˜¤ë¥˜ ë°œê²¬. ì»¤ë°‹ì´ ì¤‘ë‹¨ë©ë‹ˆë‹¤."
        exit 1
    fi
    cd ..
fi

echo "âœ… ëª¨ë“  ê²€ì‚¬ë¥¼ í†µê³¼í–ˆìŠµë‹ˆë‹¤. ì»¤ë°‹ì„ ì§„í–‰í•©ë‹ˆë‹¤."